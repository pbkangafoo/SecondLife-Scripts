// -----------------------------------------------------------------------------------------------
// --- Project: Away push script
// -----------------------------------------------------------------------------------------------

// -----------------------------------------------------------------------------------------------
// --- Type: Module 
// --- Name: Away push script
// --- Vers: 0.1
// --- Desc: This module is supposed to keep pushing your target away.
// --- Written by Peter Bartels
// -----------------------------------------------------------------------------------------------

// -----------------------------------------------------------------------------------------------
// --- Changelog:
// ---        Version: 0.1
// ---            + first relase
// -----------------------------------------------------------------------------------------------


// -----------------------------------------------------------------------------------------------
// --- General settings and storage --------------------------------------------------------------
// -----------------------------------------------------------------------------------------------

key target_key = NULL_KEY;

// -----------------------------------------------------------------------------------------------
// --- Global functions and procedures -----------------------------------------------------------
// -----------------------------------------------------------------------------------------------


// -----------------------------------------------------------------------------------------------
// --- Main part starts here ---------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------

default
{
	on_rez(integer start_param)
	{
		llResetScript();
	}
	
	link_message(integer sender_number, integer num, string str, key id)
    {
		if((num == -47111)&&(str == "target"))
		{
			target_key = id;
		}
		else
		if((num == -99901) && (str == "away"))
		{
			llSetTimerEvent(0.1);
		}
		else
		if((num == -99900) && (str == "end"))
		{
			llSetTimerEvent(0.0);
			llResetScript();
		}
	}

	timer()
	{
		list p = llGetObjectDetails(target_key,[OBJECT_POS]);
        vector dest = llList2Vector(p,0);
        integer i=0;
        while(i<10)
        {
            float f_Force;
            if(llGetAgentInfo((target_key)) & AGENT_IN_AIR) f_Force = 1.0; else f_Force = 999999.0;
            llPushObject(target_key, llVecNorm(dest - llGetPos()) * f_Force * llGetObjectMass(target_key) * llPow(llVecDist(llGetPos(), dest), 3), ZERO_VECTOR, FALSE);
            i++;
        }
	}
		
}